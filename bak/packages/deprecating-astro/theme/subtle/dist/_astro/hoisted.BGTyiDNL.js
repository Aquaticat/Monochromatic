const header=document.querySelector("header"),footer=document.querySelector("footer"),addCSS=css=>document.head.appendChild(document.createElement("style")).innerHTML=css;addCSS(`main {
  min-block-size: calc(100dvb - ${window.getComputedStyle(header).getPropertyValue("block-size")} - ${window.getComputedStyle(footer).getPropertyValue("block-size")});
}`);document.querySelectorAll("details").forEach(details=>{details.addEventListener("toggle",()=>{if(details.hasAttribute("open")){let parentDetails;do parentDetails=details.parentElement.closest("details:not([open])"),parentDetails&&(parentDetails.open=!0);while(parentDetails!==null)}})});const prefers=new Map([["contrast","reduced-motion","reduced-data","reduced-transparency"].map(val=>Object.freeze([val,Object.freeze(new Set(["toggle","true","false"]))])),["color-scheme"].map(val=>Object.freeze([val,Object.freeze(new Set(["toggle","light","dark"]))]))].flat());prefers.forEach((possibleVals,prefer)=>{const preferVal=new URLSearchParams(location.search).get(prefer);if(preferVal)if(possibleVals.has(preferVal))document.documentElement.setAttribute(`data-${prefer}`,preferVal);else throw TypeError(`query param ${prefer}'s value must be one of ${JSON.stringify(possibleVals)}, got ${preferVal}`)});const q=new URLSearchParams(location.search).get("q");q&&(location.href=`https://duckduckgo.com/?q=${encodeURIComponent(q)}+${encodeURIComponent(`site:${location.origin}`)}`);function isLang(str){return str.length===2&&/^[a-z]+$/.test(str)||str.length===5&&/^[a-z]{2}-[A-Z]{2}$/.test(str)}const consts=Object.freeze(Object.fromEntries([["title","Subtle"],["description","Personal Blog Theme for Astro"],["author","Aquaticat"],["site","https://monochromatic.dev"],["base","subtle"],["theming",Object.freeze(Object.fromEntries([["color","#966783"],["shiki",Object.freeze(Object.fromEntries([["light","github-light"],["dark","github-dark"]]))]]))],["socials",Object.freeze(new Map([["RSS Feed","https://aquati.cat/rss"],["Email","mailto:an@aquati.cat?subject=Email author of Monochromatic/Subtle"],["GitHub","https://github.com/Aquaticat"],["Telegram","https://t.me/Aquaticat"]]))],["links",Object.freeze(new Map([["Catoverflow","https://c-j.dev"],["dummy1","https://example.com"],["big dummy2","https://example.com"],["big big dummy1","https://example.com"],["big big dummy2","https://example.com"],["dummy3","https://example.com"],["dummy4","https://example.com"],["dummy5","https://example.com"],["dummy6","https://example.com"]]))],["langs",Object.freeze(Object.fromEntries([["defaultLang","en"],["paths",Object.freeze(["","zh"])],["langs",Object.freeze(["en","zh"])],["mappings",Object.freeze(new Map([["en",""],["en-US",""],["en-CA",""],["en-UK",""],["en-GB",""],["zh","zh"],["zh-CN","zh"],["zh-TW","zh"]]))]]))],["strings",Object.freeze(new Map([["en",Object.freeze(new Map([["404","You've landed on an unknown page."],["tempUnavailable","Sorry, this page is not available in your language yet. Please check back later"],["unsupported","Sorry, this site is not available in your language."],["searchPlaceholder","Search tags, topics, or snippets"]]))],["zh",Object.freeze(new Map([["404","未知领域"],["tempUnavailable","抱歉，此页暂时无所选语言的版本，请稍后再看。"],["unsupported","抱歉，此网站不支持所选语言。"],["searchPlaceholder","搜索关键词，话题，或文段"]]))]]))]])),exists=async url=>{try{return await fetch(url).then(response=>response.ok)}catch{return!1}},trimEndWith=(str,trimmer)=>{const reversedTrimmer=trimmer.split("").toReversed().join();let modifingString=str;for(;modifingString.endsWith(trimmer);)modifingString=modifingString.split("").toReversed().join("").replace(reversedTrimmer,"").split("").toReversed().join("");return modifingString},trimStartWith=(str,trimmer)=>{let modifingString=str;for(;modifingString.startsWith(trimmer);)modifingString=modifingString.replace(trimmer,"");return modifingString},filterPromise=(values,fn)=>Promise.all(values.map(fn)).then(booleans=>values.filter((_,i)=>booleans[i])),pathSegmentAfterBase=trimStartWith(trimStartWith(trimStartWith(location.pathname,"/"),consts.base),"/"),firstPathSegmentAfterBase=pathSegmentAfterBase?pathSegmentAfterBase.includes("/")?pathSegmentAfterBase.split("/")[0]:pathSegmentAfterBase:"",isFirstPathSegmentAfterBaseLang=isLang(firstPathSegmentAfterBase),pathSegmentAfterBaseWithoutLang=trimStartWith(isFirstPathSegmentAfterBaseLang?trimStartWith(pathSegmentAfterBase,firstPathSegmentAfterBase):pathSegmentAfterBase,"/"),originWithBase=`${location.origin}/${consts.base}`,is404=document.head.querySelector('meta[name="title"]').getAttribute("content")==="404",urlsOfActualSupportedLangsForPage=await filterPromise(consts.langs.paths.map(langPath=>langPath===""?`${originWithBase}/${pathSegmentAfterBaseWithoutLang}`:`${originWithBase}/${langPath}/${pathSegmentAfterBaseWithoutLang}`),exists),actualSupportedLangsForPage=urlsOfActualSupportedLangsForPage.map(url=>{const path=trimEndWith(trimEndWith(trimStartWith(url,`${originWithBase}/`),pathSegmentAfterBaseWithoutLang),"/");return path===""?consts.langs.defaultLang:path}),requestedLangs=isFirstPathSegmentAfterBaseLang?[firstPathSegmentAfterBase]:navigator.languages;consts.langs.langs.some(lang=>requestedLangs.includes(lang));actualSupportedLangsForPage.some(lang=>requestedLangs.includes(lang));isFirstPathSegmentAfterBaseLang&&is404&&(urlsOfActualSupportedLangsForPage.length===0||(document.querySelectorAll("[data-id='tempUnavailable']").forEach(elm=>{elm.removeAttribute("hidden")}),document.querySelectorAll("[data-id='404']").forEach(elm=>{elm.setAttribute("hidden","true")})));const autoFocus=()=>HTMLElement.prototype.hasOwnProperty("autofocus");autoFocus||document.querySelector("#search").addEventListener("toggle",event=>{event.newState==="open"&&document.querySelector('input[name="q"]').focus()});
