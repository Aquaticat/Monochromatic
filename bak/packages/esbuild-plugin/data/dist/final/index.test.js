var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value2)=>__defProp(target,"name",{value:value2,configurable:!0});var __commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from=="object"||typeof from=="function")for(let key of __getOwnPropNames(from))!__hasOwnProp.call(to,key)&&key!==except&&__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target,mod));var require_ini=__commonJS({"../../../.yarn/cache/ini-npm-4.1.3-56188f3216-0d27eff094.zip/node_modules/ini/lib/ini.js"(exports,module){var{hasOwnProperty}=Object.prototype,encode=__name((obj,opt={})=>{typeof opt=="string"&&(opt={section:opt}),opt.align=opt.align===!0,opt.newline=opt.newline===!0,opt.sort=opt.sort===!0,opt.whitespace=opt.whitespace===!0||opt.align===!0,opt.platform=opt.platform||typeof process<"u"&&process.platform,opt.bracketedArray=opt.bracketedArray!==!1;let eol=opt.platform==="win32"?`\r
`:`
`,separator=opt.whitespace?" = ":"=",children=[],keys=opt.sort?Object.keys(obj).sort():Object.keys(obj),padToChars=0;opt.align&&(padToChars=safe(keys.filter(k=>obj[k]===null||Array.isArray(obj[k])||typeof obj[k]!="object").map(k=>Array.isArray(obj[k])?`${k}[]`:k).concat([""]).reduce((a,b)=>safe(a).length>=safe(b).length?a:b)).length);let out="",arraySuffix=opt.bracketedArray?"[]":"";for(let k of keys){let val=obj[k];if(val&&Array.isArray(val))for(let item of val)out+=safe(`${k}${arraySuffix}`).padEnd(padToChars," ")+separator+safe(item)+eol;else val&&typeof val=="object"?children.push(k):out+=safe(k).padEnd(padToChars," ")+separator+safe(val)+eol}opt.section&&out.length&&(out="["+safe(opt.section)+"]"+(opt.newline?eol+eol:eol)+out);for(let k of children){let nk=splitSections(k,".").join("\\."),section=(opt.section?opt.section+".":"")+nk,child=encode(obj[k],{...opt,section});out.length&&child.length&&(out+=eol),out+=child}return out},"encode");function splitSections(str2,separator){var lastMatchIndex=0,lastSeparatorIndex=0,nextIndex=0,sections=[];do if(nextIndex=str2.indexOf(separator,lastMatchIndex),nextIndex!==-1){if(lastMatchIndex=nextIndex+separator.length,nextIndex>0&&str2[nextIndex-1]==="\\")continue;sections.push(str2.slice(lastSeparatorIndex,nextIndex)),lastSeparatorIndex=nextIndex+separator.length}while(nextIndex!==-1);return sections.push(str2.slice(lastSeparatorIndex)),sections}__name(splitSections,"splitSections");var decode=__name((str2,opt={})=>{opt.bracketedArray=opt.bracketedArray!==!1;let out=Object.create(null),p=out,section=null,re=/^\[([^\]]*)\]\s*$|^([^=]+)(=(.*))?$/i,lines=str2.split(/[\r\n]+/g),duplicates={};for(let line of lines){if(!line||line.match(/^\s*[;#]/)||line.match(/^\s*$/))continue;let match=line.match(re);if(!match)continue;if(match[1]!==void 0){if(section=unsafe(match[1]),section==="__proto__"){p=Object.create(null);continue}p=out[section]=out[section]||Object.create(null);continue}let keyRaw=unsafe(match[2]),isArray2;opt.bracketedArray?isArray2=keyRaw.length>2&&keyRaw.slice(-2)==="[]":(duplicates[keyRaw]=(duplicates?.[keyRaw]||0)+1,isArray2=duplicates[keyRaw]>1);let key=isArray2&&keyRaw.endsWith("[]")?keyRaw.slice(0,-2):keyRaw;if(key==="__proto__")continue;let valueRaw=match[3]?unsafe(match[4]):!0,value2=valueRaw==="true"||valueRaw==="false"||valueRaw==="null"?JSON.parse(valueRaw):valueRaw;isArray2&&(hasOwnProperty.call(p,key)?Array.isArray(p[key])||(p[key]=[p[key]]):p[key]=[]),Array.isArray(p[key])?p[key].push(value2):p[key]=value2}let remove=[];for(let k of Object.keys(out)){if(!hasOwnProperty.call(out,k)||typeof out[k]!="object"||Array.isArray(out[k]))continue;let parts=splitSections(k,".");p=out;let l=parts.pop(),nl=l.replace(/\\\./g,".");for(let part of parts)part!=="__proto__"&&((!hasOwnProperty.call(p,part)||typeof p[part]!="object")&&(p[part]=Object.create(null)),p=p[part]);p===out&&nl===l||(p[nl]=out[k],remove.push(k))}for(let del of remove)delete out[del];return out},"decode"),isQuoted=__name(val=>val.startsWith('"')&&val.endsWith('"')||val.startsWith("'")&&val.endsWith("'"),"isQuoted"),safe=__name(val=>typeof val!="string"||val.match(/[=\r\n]/)||val.match(/^\[/)||val.length>1&&isQuoted(val)||val!==val.trim()?JSON.stringify(val):val.split(";").join("\\;").split("#").join("\\#"),"safe"),unsafe=__name(val=>{if(val=(val||"").trim(),isQuoted(val)){val.charAt(0)==="'"&&(val=val.slice(1,-1));try{val=JSON.parse(val)}catch{}}else{let esc=!1,unesc="";for(let i=0,l=val.length;i<l;i++){let c=val.charAt(i);if(esc)"\\;#".indexOf(c)!==-1?unesc+=c:unesc+="\\"+c,esc=!1;else{if(";#".indexOf(c)!==-1)break;c==="\\"?esc=!0:unesc+=c}}return esc&&(unesc+="\\"),unesc.trim()}return val},"unsafe");module.exports={parse:decode,decode,stringify:encode,encode,safe,unsafe}}});import assert from"node:assert/strict";import{describe,it}from"node:test";import{fs,path}from"@monochromatic-dev/module-fs-path";var __defProp2=Object.defineProperty,__name2=__name((target,value2)=>__defProp2(target,"name",{value:value2,configurable:!0}),"__name"),__defProp22=Object.defineProperty,__name22=__name2((target,value2)=>__defProp22(target,"name",{value:value2,configurable:!0}),"__name"),src_default=__name22(obj=>{switch(!0){case obj===null:return"null";case obj===void 0:return"undefined";case Number.isNaN(obj):return"NaN";case typeof obj=="number":return"number";case typeof obj=="boolean":return"boolean";case typeof obj=="bigint":return"bigint";case typeof obj=="symbol":return"symbol";case typeof obj=="string":return"string";case Array.isArray(obj):return"array";case obj instanceof Date:return"date";case obj instanceof Set:return"set";case obj instanceof Map:return"map";case String(obj).startsWith("[object Object]"):return"object";default:throw TypeError(`Unrecognized obj ${obj} ${JSON.stringify(obj)} ${typeof obj}`)}},"default"),unsupported=Object.freeze(["null","undefined","NaN","bigint","symbol"]),primitive=Object.freeze(["boolean","string","number","date"]);function toExport(obj){let objType=src_default(obj);if(unsupported.includes(objType))throw new TypeError(`Unsupported obj ${obj} ${JSON.stringify(obj)} type ${objType}`);if(primitive.includes(objType))switch(objType){case"boolean":return String(obj);case"number":return String(obj);case"string":return`${JSON.stringify(obj)}`;case"date":return`new Date(${JSON.stringify(obj)})`}switch(objType){case"set":return`Object.freeze(new Set([${Array.from(obj).map(([k,v])=>`[${toExport(k)}, ${toExport(v)}]`)}]))`;case"map":return`Object.freeze(new Map([${Array.from(obj).map(([k,v])=>`[${toExport(k)}, ${toExport(v)}]`)}]))`;case"array":return`Object.freeze([${obj.map(i=>toExport(i))}])`;case"object":return`Object.freeze(Object.fromEntries([${Object.entries(obj).map(([k,v])=>`[${toExport(k)}, ${toExport(v)}]`)}]))`;default:throw new TypeError(`Unknown obj ${obj} ${JSON.stringify(obj)} type ${objType}`)}}__name(toExport,"toExport");__name2(toExport,"toExport");import pm from"@monochromatic-dev/module-pm";import resolve from"@monochromatic-dev/module-resolve";function parse(text){if(new.target)throw new TypeError("parse is not a constructor");return new JSONCParser(text).parse()}__name(parse,"parse");var JSONCParser=class{static{__name(this,"JSONCParser")}#whitespace=new Set(` 	\r
`);#numberEndToken=new Set([..."[]{}:,/",...this.#whitespace]);#text;#length;#tokenized;constructor(text){this.#text=`${text}`,this.#length=this.#text.length,this.#tokenized=this.#tokenize()}parse(){let token=this.#getNext(),res=this.#parseJsonValue(token),{done,value:value2}=this.#tokenized.next();if(!done)throw new SyntaxError(buildErrorMessage(value2));return res}#getNext(){let{done,value:value2}=this.#tokenized.next();if(done)throw new SyntaxError("Unexpected end of JSONC input");return value2}*#tokenize(){for(let i=0;i<this.#length;i++)if(!this.#whitespace.has(this.#text[i])){if(this.#text[i]==="/"&&this.#text[i+1]==="*"){i+=2;let hasEndOfComment=!1;for(;i<this.#length;i++)if(this.#text[i]==="*"&&this.#text[i+1]==="/"){hasEndOfComment=!0;break}if(!hasEndOfComment)throw new SyntaxError("Unexpected end of JSONC input");i++;continue}if(this.#text[i]==="/"&&this.#text[i+1]==="/"){for(i+=2;i<this.#length&&!(this.#text[i]===`
`||this.#text[i]==="\r");i++);continue}switch(this.#text[i]){case"{":yield{type:"BeginObject",position:i};break;case"}":yield{type:"EndObject",position:i};break;case"[":yield{type:"BeginArray",position:i};break;case"]":yield{type:"EndArray",position:i};break;case":":yield{type:"NameSeparator",position:i};break;case",":yield{type:"ValueSeparator",position:i};break;case'"':{let startIndex=i,shouldEscapeNext=!1;for(i++;i<this.#length&&!(this.#text[i]==='"'&&!shouldEscapeNext);i++)shouldEscapeNext=this.#text[i]==="\\"&&!shouldEscapeNext;yield{type:"String",sourceText:this.#text.substring(startIndex,i+1),position:startIndex};break}default:{let startIndex=i;for(;i<this.#length&&!this.#numberEndToken.has(this.#text[i]);i++);i--,yield{type:"NullOrTrueOrFalseOrNumber",sourceText:this.#text.substring(startIndex,i+1),position:startIndex}}}}}#parseJsonValue(value2){switch(value2.type){case"BeginObject":return this.#parseObject();case"BeginArray":return this.#parseArray();case"NullOrTrueOrFalseOrNumber":return this.#parseNullOrTrueOrFalseOrNumber(value2);case"String":return this.#parseString(value2);default:throw new SyntaxError(buildErrorMessage(value2))}}#parseObject(){let target={};for(;;){let token1=this.#getNext();if(token1.type==="EndObject")return target;if(token1.type!=="String")throw new SyntaxError(buildErrorMessage(token1));let key=this.#parseString(token1),token2=this.#getNext();if(token2.type!=="NameSeparator")throw new SyntaxError(buildErrorMessage(token2));let token3=this.#getNext();Object.defineProperty(target,key,{value:this.#parseJsonValue(token3),writable:!0,enumerable:!0,configurable:!0});let token4=this.#getNext();if(token4.type==="EndObject")return target;if(token4.type!=="ValueSeparator")throw new SyntaxError(buildErrorMessage(token4))}}#parseArray(){let target=[];for(;;){let token1=this.#getNext();if(token1.type==="EndArray")return target;target.push(this.#parseJsonValue(token1));let token2=this.#getNext();if(token2.type==="EndArray")return target;if(token2.type!=="ValueSeparator")throw new SyntaxError(buildErrorMessage(token2))}}#parseString(value2){let parsed;try{parsed=JSON.parse(value2.sourceText)}catch{throw new SyntaxError(buildErrorMessage(value2))}if(typeof parsed!="string")throw new TypeError(`Parsed value is not a string: ${parsed}`);return parsed}#parseNullOrTrueOrFalseOrNumber(value2){if(value2.sourceText==="null")return null;if(value2.sourceText==="true")return!0;if(value2.sourceText==="false")return!1;let parsed;try{parsed=JSON.parse(value2.sourceText)}catch{throw new SyntaxError(buildErrorMessage(value2))}if(typeof parsed!="number")throw new TypeError(`Parsed value is not a number: ${parsed}`);return parsed}};function buildErrorMessage({type,sourceText,position}){let token="";switch(type){case"BeginObject":token="{";break;case"EndObject":token="}";break;case"BeginArray":token="[";break;case"EndArray":token="]";break;case"NameSeparator":token=":";break;case"ValueSeparator":token=",";break;case"NullOrTrueOrFalseOrNumber":case"String":token=30<sourceText.length?`${sourceText.slice(0,30)}...`:sourceText;break}return`Unexpected token ${token} in JSONC at position ${position}`}__name(buildErrorMessage,"buildErrorMessage");function filterInPlace(array,predicate){let outputIndex=0;for(let cur of array)predicate(cur)&&(array[outputIndex]=cur,outputIndex+=1);return array.splice(outputIndex),array}__name(filterInPlace,"filterInPlace");function deepMerge(record,other,options){return deepMergeInternal(record,other,new Set,options)}__name(deepMerge,"deepMerge");function deepMergeInternal(record,other,seen,options){let result={},keys=new Set([...getKeys(record),...getKeys(other)]);for(let key of keys){if(key==="__proto__")continue;let a=record[key];if(!Object.hasOwn(other,key)){result[key]=a;continue}let b=other[key];if(isNonNullObject(a)&&isNonNullObject(b)&&!seen.has(a)&&!seen.has(b)){seen.add(a),seen.add(b),result[key]=mergeObjects(a,b,seen,options);continue}result[key]=b}return result}__name(deepMergeInternal,"deepMergeInternal");function mergeObjects(left,right,seen,options={arrays:"merge",sets:"merge",maps:"merge"}){if(isMergeable(left)&&isMergeable(right))return deepMergeInternal(left,right,seen,options);if(isIterable(left)&&isIterable(right)){if(Array.isArray(left)&&Array.isArray(right))return options.arrays==="merge"?left.concat(right):right;if(left instanceof Map&&right instanceof Map)return options.maps==="merge"?new Map([...left,...right]):right;if(left instanceof Set&&right instanceof Set)return options.sets==="merge"?new Set([...left,...right]):right}return right}__name(mergeObjects,"mergeObjects");function isMergeable(value2){return Object.getPrototypeOf(value2)===Object.prototype}__name(isMergeable,"isMergeable");function isIterable(value2){return typeof value2[Symbol.iterator]=="function"}__name(isIterable,"isIterable");function isNonNullObject(value2){return value2!==null&&typeof value2=="object"}__name(isNonNullObject,"isNonNullObject");function getKeys(record){let result=Object.getOwnPropertySymbols(record);return filterInPlace(result,key=>Object.prototype.propertyIsEnumerable.call(record,key)),result.push(...Object.keys(record)),result}__name(getKeys,"getKeys");var Scanner=class{static{__name(this,"Scanner")}#whitespace=/[ \t]/;#position=0;#source;constructor(source){this.#source=source}char(index=0){return this.#source[this.#position+index]??""}slice(start,end){return this.#source.slice(this.#position+start,this.#position+end)}next(count){if(typeof count=="number")for(let i=0;i<count;i++)this.#position++;else this.#position++}nextUntilChar(options={comment:!0}){if(options.inline)for(;this.#whitespace.test(this.char())&&!this.eof();)this.next();else for(;!this.eof();){let char=this.char();if(this.#whitespace.test(char)||this.isCurrentCharEOL())this.next();else if(options.comment&&this.char()==="#")for(;!this.isCurrentCharEOL()&&!this.eof();)this.next();else break}if(!this.isCurrentCharEOL()&&/\s/.test(this.char())){let escaped="\\u"+this.char().charCodeAt(0).toString(16);throw new SyntaxError(`Contains invalid whitespaces: \`${escaped}\``)}}eof(){return this.position()>=this.#source.length}position(){return this.#position}isCurrentCharEOL(){return this.char()===`
`||this.slice(0,2)===`\r
`}};function success(body){return{ok:!0,body}}__name(success,"success");function failure(){return{ok:!1}}__name(failure,"failure");function unflat(keys,values={},cObj){let out={};if(keys.length===0)return cObj;cObj||(cObj=values);let key=keys[keys.length-1];return typeof key=="string"&&(out[key]=cObj),unflat(keys.slice(0,-1),values,out)}__name(unflat,"unflat");function deepAssignWithTable(target,table2){if(table2.key.length===0||table2.key[0]==null)throw new Error("Unexpected key length");let value2=target[table2.key[0]];if(typeof value2>"u")Object.assign(target,unflat(table2.key,table2.type==="Table"?table2.value:[table2.value]));else if(Array.isArray(value2))if(table2.type==="TableArray"&&table2.key.length===1)value2.push(table2.value);else{let last=value2[value2.length-1];deepAssignWithTable(last,{type:table2.type,key:table2.key.slice(1),value:table2.value})}else if(typeof value2=="object"&&value2!==null)deepAssignWithTable(value2,{type:table2.type,key:table2.key.slice(1),value:table2.value});else throw new Error("Unexpected assign")}__name(deepAssignWithTable,"deepAssignWithTable");function or(parsers){return scanner=>{for(let parse5 of parsers){let result=parse5(scanner);if(result.ok)return result}return failure()}}__name(or,"or");function join(parser,separator){let Separator=character(separator);return scanner=>{let first=parser(scanner);if(!first.ok)return failure();let out=[first.body];for(;!scanner.eof()&&Separator(scanner).ok;){let result=parser(scanner);if(!result.ok)throw new SyntaxError(`Invalid token after "${separator}"`);out.push(result.body)}return success(out)}}__name(join,"join");function kv(keyParser,separator,valueParser){let Separator=character(separator);return scanner=>{let key=keyParser(scanner);if(!key.ok)return failure();if(!Separator(scanner).ok)throw new SyntaxError(`key/value pair doesn't have "${separator}"`);let value2=valueParser(scanner);if(!value2.ok)throw new SyntaxError("Value of key/value pair is invalid data format");return success(unflat(key.body,value2.body))}}__name(kv,"kv");function merge(parser){return scanner=>{let result=parser(scanner);if(!result.ok)return failure();let body={};for(let record of result.body)typeof body=="object"&&body!==null&&(body=deepMerge(body,record));return success(body)}}__name(merge,"merge");function repeat(parser){return scanner=>{let body=[];for(;!scanner.eof();){let result=parser(scanner);if(!result.ok)break;body.push(result.body),scanner.nextUntilChar()}return body.length===0?failure():success(body)}}__name(repeat,"repeat");function surround(left,parser,right){let Left=character(left),Right=character(right);return scanner=>{if(!Left(scanner).ok)return failure();let result=parser(scanner);if(!result.ok)throw new SyntaxError(`Invalid token after "${left}"`);if(!Right(scanner).ok)throw new SyntaxError(`Not closed by "${right}" after started with "${left}"`);return success(result.body)}}__name(surround,"surround");function character(str2){return scanner=>(scanner.nextUntilChar({inline:!0}),scanner.slice(0,str2.length)!==str2?failure():(scanner.next(str2.length),scanner.nextUntilChar({inline:!0}),success(void 0)))}__name(character,"character");var BARE_KEY_REGEXP=/[A-Za-z0-9_-]/,FLOAT_REGEXP=/[0-9_\.e+\-]/i,END_OF_VALUE_REGEXP=/[ \t\r\n#,}\]]/;function bareKey(scanner){if(scanner.nextUntilChar({inline:!0}),!scanner.char()||!BARE_KEY_REGEXP.test(scanner.char()))return failure();let acc=[];for(;scanner.char()&&BARE_KEY_REGEXP.test(scanner.char());)acc.push(scanner.char()),scanner.next();let key=acc.join("");return success(key)}__name(bareKey,"bareKey");function escapeSequence(scanner){if(scanner.char()!=="\\")return failure();switch(scanner.next(),scanner.char()){case"b":return scanner.next(),success("\b");case"t":return scanner.next(),success("	");case"n":return scanner.next(),success(`
`);case"f":return scanner.next(),success("\f");case"r":return scanner.next(),success("\r");case"u":case"U":{let codePointLen=scanner.char()==="u"?4:6,codePoint=parseInt("0x"+scanner.slice(1,1+codePointLen),16),str2=String.fromCodePoint(codePoint);return scanner.next(codePointLen+1),success(str2)}case'"':return scanner.next(),success('"');case"\\":return scanner.next(),success("\\");default:throw new SyntaxError(`Invalid escape sequence: \\${scanner.char()}`)}}__name(escapeSequence,"escapeSequence");function basicString(scanner){if(scanner.nextUntilChar({inline:!0}),scanner.char()!=='"')return failure();scanner.next();let acc=[];for(;scanner.char()!=='"'&&!scanner.eof();){if(scanner.char()===`
`)throw new SyntaxError("Single-line string cannot contain EOL");let escapedChar=escapeSequence(scanner);escapedChar.ok?acc.push(escapedChar.body):(acc.push(scanner.char()),scanner.next())}if(scanner.eof())throw new SyntaxError(`Single-line string is not closed:
${acc.join("")}`);return scanner.next(),success(acc.join(""))}__name(basicString,"basicString");function literalString(scanner){if(scanner.nextUntilChar({inline:!0}),scanner.char()!=="'")return failure();scanner.next();let acc=[];for(;scanner.char()!=="'"&&!scanner.eof();){if(scanner.char()===`
`)throw new SyntaxError("Single-line string cannot contain EOL");acc.push(scanner.char()),scanner.next()}if(scanner.eof())throw new SyntaxError(`Single-line string is not closed:
${acc.join("")}`);return scanner.next(),success(acc.join(""))}__name(literalString,"literalString");function multilineBasicString(scanner){if(scanner.nextUntilChar({inline:!0}),scanner.slice(0,3)!=='"""')return failure();scanner.next(3),scanner.char()===`
`?scanner.next():scanner.slice(0,2)===`\r
`&&scanner.next(2);let acc=[];for(;scanner.slice(0,3)!=='"""'&&!scanner.eof();){if(scanner.slice(0,2)===`\\
`){scanner.next(),scanner.nextUntilChar({comment:!1});continue}else if(scanner.slice(0,3)===`\\\r
`){scanner.next(),scanner.nextUntilChar({comment:!1});continue}let escapedChar=escapeSequence(scanner);escapedChar.ok?acc.push(escapedChar.body):(acc.push(scanner.char()),scanner.next())}if(scanner.eof())throw new SyntaxError(`Multi-line string is not closed:
${acc.join("")}`);return scanner.char(3)==='"'&&(acc.push('"'),scanner.next()),scanner.next(3),success(acc.join(""))}__name(multilineBasicString,"multilineBasicString");function multilineLiteralString(scanner){if(scanner.nextUntilChar({inline:!0}),scanner.slice(0,3)!=="'''")return failure();scanner.next(3),scanner.char()===`
`?scanner.next():scanner.slice(0,2)===`\r
`&&scanner.next(2);let acc=[];for(;scanner.slice(0,3)!=="'''"&&!scanner.eof();)acc.push(scanner.char()),scanner.next();if(scanner.eof())throw new SyntaxError(`Multi-line string is not closed:
${acc.join("")}`);return scanner.char(3)==="'"&&(acc.push("'"),scanner.next()),scanner.next(3),success(acc.join(""))}__name(multilineLiteralString,"multilineLiteralString");var symbolPairs=[["true",!0],["false",!1],["inf",1/0],["+inf",1/0],["-inf",-1/0],["nan",NaN],["+nan",NaN],["-nan",NaN]];function symbols(scanner){scanner.nextUntilChar({inline:!0});let found=symbolPairs.find(([str3])=>scanner.slice(0,str3.length)===str3);if(!found)return failure();let[str2,value2]=found;return scanner.next(str2.length),success(value2)}__name(symbols,"symbols");var dottedKey=join(or([bareKey,basicString,literalString]),".");function integer(scanner){scanner.nextUntilChar({inline:!0});let first2=scanner.slice(0,2);if(first2.length===2&&/0(?:x|o|b)/i.test(first2)){scanner.next(2);let acc2=[first2];for(;/[0-9a-f_]/i.test(scanner.char())&&!scanner.eof();)acc2.push(scanner.char()),scanner.next();return acc2.length===1?failure():success(acc2.join(""))}let acc=[];for(/[+-]/.test(scanner.char())&&(acc.push(scanner.char()),scanner.next());/[0-9_]/.test(scanner.char())&&!scanner.eof();)acc.push(scanner.char()),scanner.next();if(acc.length===0||acc.length===1&&/[+-]/.test(acc[0]))return failure();let int2=parseInt(acc.filter(char=>char!=="_").join(""));return success(int2)}__name(integer,"integer");function float(scanner){scanner.nextUntilChar({inline:!0});let position=0;for(;scanner.char(position)&&!END_OF_VALUE_REGEXP.test(scanner.char(position));){if(!FLOAT_REGEXP.test(scanner.char(position)))return failure();position++}let acc=[];for(/[+-]/.test(scanner.char())&&(acc.push(scanner.char()),scanner.next());FLOAT_REGEXP.test(scanner.char())&&!scanner.eof();)acc.push(scanner.char()),scanner.next();if(acc.length===0)return failure();let float3=parseFloat(acc.filter(char=>char!=="_").join(""));return isNaN(float3)?failure():success(float3)}__name(float,"float");function dateTime(scanner){scanner.nextUntilChar({inline:!0});let dateStr=scanner.slice(0,10);if(!/^\d{4}-\d{2}-\d{2}/.test(dateStr))return failure();scanner.next(10);let acc=[];for(;/[ 0-9TZ.:-]/.test(scanner.char())&&!scanner.eof();)acc.push(scanner.char()),scanner.next();dateStr+=acc.join("");let date=new Date(dateStr.trim());if(isNaN(date.getTime()))throw new SyntaxError(`Invalid date string "${dateStr}"`);return success(date)}__name(dateTime,"dateTime");function localTime(scanner){scanner.nextUntilChar({inline:!0});let timeStr=scanner.slice(0,8);if(!/^(\d{2}):(\d{2}):(\d{2})/.test(timeStr))return failure();scanner.next(8);let acc=[];if(scanner.char()!==".")return success(timeStr);for(acc.push(scanner.char()),scanner.next();/[0-9]/.test(scanner.char())&&!scanner.eof();)acc.push(scanner.char()),scanner.next();return timeStr+=acc.join(""),success(timeStr)}__name(localTime,"localTime");function arrayValue(scanner){if(scanner.nextUntilChar({inline:!0}),scanner.char()!=="[")return failure();scanner.next();let array=[];for(;!scanner.eof();){scanner.nextUntilChar();let result=value(scanner);if(!result.ok||(array.push(result.body),scanner.nextUntilChar({inline:!0}),scanner.char()!==","))break;scanner.next()}if(scanner.nextUntilChar(),scanner.char()!=="]")throw new SyntaxError("Array is not closed");return scanner.next(),success(array)}__name(arrayValue,"arrayValue");function inlineTable(scanner){if(scanner.nextUntilChar(),scanner.char(1)==="}")return scanner.next(2),success({});let pairs2=surround("{",join(pair,","),"}")(scanner);if(!pairs2.ok)return failure();let table2={};for(let pair2 of pairs2.body)table2=deepMerge(table2,pair2);return success(table2)}__name(inlineTable,"inlineTable");var value=or([multilineBasicString,multilineLiteralString,basicString,literalString,symbols,dateTime,localTime,float,integer,arrayValue,inlineTable]),pair=kv(dottedKey,"=",value);function block(scanner){scanner.nextUntilChar();let result=merge(repeat(pair))(scanner);return result.ok?success({type:"Block",value:result.body}):failure()}__name(block,"block");var tableHeader=surround("[",dottedKey,"]");function table(scanner){scanner.nextUntilChar();let header=tableHeader(scanner);if(!header.ok)return failure();scanner.nextUntilChar();let b=block(scanner);return success({type:"Table",key:header.body,value:b.ok?b.body.value:{}})}__name(table,"table");var tableArrayHeader=surround("[[",dottedKey,"]]");function tableArray(scanner){scanner.nextUntilChar();let header=tableArrayHeader(scanner);if(!header.ok)return failure();scanner.nextUntilChar();let b=block(scanner);return success({type:"TableArray",key:header.body,value:b.ok?b.body.value:{}})}__name(tableArray,"tableArray");function toml(scanner){let blocks=repeat(or([block,tableArray,table]))(scanner);if(!blocks.ok)return failure();let body={};for(let block2 of blocks.body)switch(block2.type){case"Block":{body=deepMerge(body,block2.value);break}case"Table":{deepAssignWithTable(body,block2);break}case"TableArray":{deepAssignWithTable(body,block2);break}}return success(body)}__name(toml,"toml");function parserFactory(parser){return tomlString=>{let scanner=new Scanner(tomlString),parsed=null,err=null;try{parsed=parser(scanner)}catch(e){err=e instanceof Error?e:new Error("[non-error thrown]")}if(err||!parsed||!parsed.ok||!scanner.eof()){let position=scanner.position(),subStr=tomlString.slice(0,position),lines=subStr.split(`
`),row=lines.length,column=(()=>{let count=subStr.length;for(let line of lines){if(count<=line.length)break;count-=line.length+1}return count})(),message=`Parse error on line ${row}, column ${column}: ${err?err.message:`Unexpected character: "${scanner.char()}"`}`;throw new SyntaxError(message)}return parsed.body}}__name(parserFactory,"parserFactory");function parse2(tomlString){return parserFactory(toml)(tomlString)}__name(parse2,"parse");function isEOL(c){return c===10||c===13}__name(isEOL,"isEOL");function isWhiteSpace(c){return c===9||c===32}__name(isWhiteSpace,"isWhiteSpace");function isWhiteSpaceOrEOL(c){return isWhiteSpace(c)||isEOL(c)}__name(isWhiteSpaceOrEOL,"isWhiteSpaceOrEOL");function isFlowIndicator(c){return c===44||c===91||c===93||c===123||c===125}__name(isFlowIndicator,"isFlowIndicator");var DELIMITERS=`\0\r
\u2028\u2029`,Mark=class{static{__name(this,"Mark")}buffer;position;line;column;constructor(buffer,position,line,column){this.buffer=buffer,this.position=position,this.line=line,this.column=column}getSnippet(){if(!this.buffer)return null;let start=this.position,end=this.position,head="",tail="";for(;start>0&&!DELIMITERS.includes(this.buffer.charAt(start-1));)if(start--,this.position-start>75/2-1){head=" ... ",start+=5;break}for(;end<this.buffer.length&&!DELIMITERS.includes(this.buffer.charAt(end));)if(end++,end-this.position>75/2-1){tail=" ... ",end-=5;break}let snippet=this.buffer.slice(start,end),indent=" ".repeat(4),caretIndent=" ".repeat(4+this.position-start+head.length);return`${indent+head+snippet+tail}
${caretIndent}^`}toString(){let where=`at line ${this.line+1}, column ${this.column+1}`,snippet=this.getSnippet();return snippet&&(where+=`:
${snippet}`),where}};var BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function resolveYamlBinary(data){if(data===null)return!1;let code,bitlen=0,max=data.length,map2=BASE64_MAP;for(let idx=0;idx<max;idx++)if(code=map2.indexOf(data.charAt(idx)),!(code>64)){if(code<0)return!1;bitlen+=6}return bitlen%8===0}__name(resolveYamlBinary,"resolveYamlBinary");function constructYamlBinary(data){let input=data.replace(/[\r\n=]/g,""),max=input.length,map2=BASE64_MAP,result=[],bits=0;for(let idx=0;idx<max;idx++)idx%4===0&&idx&&(result.push(bits>>16&255),result.push(bits>>8&255),result.push(bits&255)),bits=bits<<6|map2.indexOf(input.charAt(idx));let tailbits=max%4*6;return tailbits===0?(result.push(bits>>16&255),result.push(bits>>8&255),result.push(bits&255)):tailbits===18?(result.push(bits>>10&255),result.push(bits>>2&255)):tailbits===12&&result.push(bits>>4&255),new Uint8Array(result)}__name(constructYamlBinary,"constructYamlBinary");function representYamlBinary(object){let max=object.length,map2=BASE64_MAP,result="",bits=0;for(let idx=0;idx<max;idx++)idx%3===0&&idx&&(result+=map2[bits>>18&63],result+=map2[bits>>12&63],result+=map2[bits>>6&63],result+=map2[bits&63]),bits=(bits<<8)+object[idx];let tail=max%3;return tail===0?(result+=map2[bits>>18&63],result+=map2[bits>>12&63],result+=map2[bits>>6&63],result+=map2[bits&63]):tail===2?(result+=map2[bits>>10&63],result+=map2[bits>>4&63],result+=map2[bits<<2&63],result+=map2[64]):tail===1&&(result+=map2[bits>>2&63],result+=map2[bits<<4&63],result+=map2[64],result+=map2[64]),result}__name(representYamlBinary,"representYamlBinary");function isBinary(obj){return obj instanceof Uint8Array}__name(isBinary,"isBinary");var binary={tag:"tag:yaml.org,2002:binary",construct:constructYamlBinary,kind:"scalar",predicate:isBinary,represent:representYamlBinary,resolve:resolveYamlBinary};function isBoolean(value2){return typeof value2=="boolean"||value2 instanceof Boolean}__name(isBoolean,"isBoolean");function isObject(value2){return value2!==null&&typeof value2=="object"}__name(isObject,"isObject");function isNegativeZero(i){return i===0&&Number.NEGATIVE_INFINITY===1/i}__name(isNegativeZero,"isNegativeZero");function getObjectTypeString(object){return Object.prototype.toString.call(object)}__name(getObjectTypeString,"getObjectTypeString");function resolveYamlBoolean(data){return data==="true"||data==="True"||data==="TRUE"||data==="false"||data==="False"||data==="FALSE"}__name(resolveYamlBoolean,"resolveYamlBoolean");function constructYamlBoolean(data){return data==="true"||data==="True"||data==="TRUE"}__name(constructYamlBoolean,"constructYamlBoolean");var bool={tag:"tag:yaml.org,2002:bool",construct:constructYamlBoolean,defaultStyle:"lowercase",kind:"scalar",predicate:isBoolean,represent:{lowercase(object){return object?"true":"false"},uppercase(object){return object?"TRUE":"FALSE"},camelcase(object){return object?"True":"False"}},resolve:resolveYamlBoolean};var YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(data){return!(!YAML_FLOAT_PATTERN.test(data)||data[data.length-1]==="_")}__name(resolveYamlFloat,"resolveYamlFloat");function constructYamlFloat(data){let value2=data.replace(/_/g,"").toLowerCase(),sign=value2[0]==="-"?-1:1;return value2[0]&&"+-".includes(value2[0])&&(value2=value2.slice(1)),value2===".inf"?sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:value2===".nan"?NaN:sign*parseFloat(value2)}__name(constructYamlFloat,"constructYamlFloat");var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(object,style){if(isNaN(object))switch(style){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===object)switch(style){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===object)switch(style){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(isNegativeZero(object))return"-0.0";let res=object.toString(10);return SCIENTIFIC_WITHOUT_DOT.test(res)?res.replace("e",".e"):res}__name(representYamlFloat,"representYamlFloat");function isFloat(object){return typeof object=="number"&&(object%1!==0||isNegativeZero(object))}__name(isFloat,"isFloat");var float2={tag:"tag:yaml.org,2002:float",construct:constructYamlFloat,defaultStyle:"lowercase",kind:"scalar",predicate:isFloat,represent:representYamlFloat,resolve:resolveYamlFloat};function isCharCodeInRange(c,lower,upper){return lower<=c&&c<=upper}__name(isCharCodeInRange,"isCharCodeInRange");function isHexCode(c){return isCharCodeInRange(c,48,57)||isCharCodeInRange(c,65,70)||isCharCodeInRange(c,97,102)}__name(isHexCode,"isHexCode");function isOctCode(c){return isCharCodeInRange(c,48,55)}__name(isOctCode,"isOctCode");function isDecCode(c){return isCharCodeInRange(c,48,57)}__name(isDecCode,"isDecCode");function resolveYamlInteger(data){let max=data.length,index=0,hasDigits=!1;if(!max)return!1;let ch=data[index];if((ch==="-"||ch==="+")&&(ch=data[++index]),ch==="0"){if(index+1===max)return!0;if(ch=data[++index],ch==="b"){for(index++;index<max;index++)if(ch=data[index],ch!=="_"){if(ch!=="0"&&ch!=="1")return!1;hasDigits=!0}return hasDigits&&ch!=="_"}if(ch==="x"){for(index++;index<max;index++)if(ch=data[index],ch!=="_"){if(!isHexCode(data.charCodeAt(index)))return!1;hasDigits=!0}return hasDigits&&ch!=="_"}for(;index<max;index++)if(ch=data[index],ch!=="_"){if(!isOctCode(data.charCodeAt(index)))return!1;hasDigits=!0}return hasDigits&&ch!=="_"}if(ch==="_")return!1;for(;index<max;index++)if(ch=data[index],ch!=="_"){if(!isDecCode(data.charCodeAt(index)))return!1;hasDigits=!0}return!hasDigits||ch==="_"?!1:/^(:[0-5]?[0-9])+$/.test(data.slice(index))}__name(resolveYamlInteger,"resolveYamlInteger");function constructYamlInteger(data){let value2=data;value2.includes("_")&&(value2=value2.replace(/_/g,""));let sign=1,ch=value2[0];return(ch==="-"||ch==="+")&&(ch==="-"&&(sign=-1),value2=value2.slice(1),ch=value2[0]),value2==="0"?0:ch==="0"?value2[1]==="b"?sign*parseInt(value2.slice(2),2):value2[1]==="x"?sign*parseInt(value2,16):sign*parseInt(value2,8):sign*parseInt(value2,10)}__name(constructYamlInteger,"constructYamlInteger");function isInteger(object){return typeof object=="number"&&object%1===0&&!isNegativeZero(object)}__name(isInteger,"isInteger");var int={tag:"tag:yaml.org,2002:int",construct:constructYamlInteger,defaultStyle:"decimal",kind:"scalar",predicate:isInteger,represent:{binary(obj){return obj>=0?`0b${obj.toString(2)}`:`-0b${obj.toString(2).slice(1)}`},octal(obj){return obj>=0?`0${obj.toString(8)}`:`-0${obj.toString(8).slice(1)}`},decimal(obj){return obj.toString(10)},hexadecimal(obj){return obj>=0?`0x${obj.toString(16).toUpperCase()}`:`-0x${obj.toString(16).toUpperCase().slice(1)}`}},resolve:resolveYamlInteger};var map={tag:"tag:yaml.org,2002:map",resolve(){return!0},construct(data){return data!==null?data:{}},kind:"mapping"};function resolveYamlMerge(data){return data==="<<"||data===null}__name(resolveYamlMerge,"resolveYamlMerge");var merge2={tag:"tag:yaml.org,2002:merge",kind:"scalar",resolve:resolveYamlMerge,construct(data){return data}};function resolveYamlNull(data){let max=data.length;return max===1&&data==="~"||max===4&&(data==="null"||data==="Null"||data==="NULL")}__name(resolveYamlNull,"resolveYamlNull");function constructYamlNull(){return null}__name(constructYamlNull,"constructYamlNull");function isNull(object){return object===null}__name(isNull,"isNull");var nil={tag:"tag:yaml.org,2002:null",construct:constructYamlNull,defaultStyle:"lowercase",kind:"scalar",predicate:isNull,represent:{lowercase(){return"null"},uppercase(){return"NULL"},camelcase(){return"Null"}},resolve:resolveYamlNull};function resolveYamlOmap(data){let objectKeys=[],pairKey="",pairHasKey=!1;for(let pair2 of data){if(pairHasKey=!1,getObjectTypeString(pair2)!=="[object Object]")return!1;for(pairKey in pair2)if(Object.hasOwn(pair2,pairKey))if(!pairHasKey)pairHasKey=!0;else return!1;if(!pairHasKey)return!1;if(!objectKeys.includes(pairKey))objectKeys.push(pairKey);else return!1}return!0}__name(resolveYamlOmap,"resolveYamlOmap");var omap={tag:"tag:yaml.org,2002:omap",kind:"sequence",resolve:resolveYamlOmap,construct(data){return data}};function resolveYamlPairs(data){if(data===null)return!0;let result=Array.from({length:data.length});for(let[index,pair2]of data.entries()){if(getObjectTypeString(pair2)!=="[object Object]")return!1;let keys=Object.keys(pair2);if(keys.length!==1)return!1;result[index]=[keys[0],pair2[keys[0]]]}return!0}__name(resolveYamlPairs,"resolveYamlPairs");function constructYamlPairs(data){if(data===null)return[];let result=Array.from({length:data.length});for(let index=0;index<data.length;index+=1){let pair2=data[index],keys=Object.keys(pair2);result[index]=[keys[0],pair2[keys[0]]]}return result}__name(constructYamlPairs,"constructYamlPairs");var pairs={tag:"tag:yaml.org,2002:pairs",construct:constructYamlPairs,kind:"sequence",resolve:resolveYamlPairs};var REGEXP=/^\/(?<regexp>[\s\S]+)\/(?<modifiers>[gismuy]*)$/,regexp={tag:"tag:yaml.org,2002:js/regexp",kind:"scalar",resolve(data){if(data===null||!data.length)return!1;let regexp2=`${data}`;if(regexp2.charAt(0)==="/"){if(!REGEXP.test(data))return!1;let modifiers=[...regexp2.match(REGEXP)?.groups?.modifiers??""];if(new Set(modifiers).size<modifiers.length)return!1}return!0},construct(data){let{regexp:regexp2=`${data}`,modifiers=""}=`${data}`.match(REGEXP)?.groups??{};return new RegExp(regexp2,modifiers)},predicate(object){return object instanceof RegExp},represent(object){return object.toString()}};var seq={tag:"tag:yaml.org,2002:seq",resolve(){return!0},construct(data){return data!==null?data:[]},kind:"sequence"};function resolveYamlSet(data){if(data===null)return!0;for(let key in data)if(Object.hasOwn(data,key)&&data[key]!==null)return!1;return!0}__name(resolveYamlSet,"resolveYamlSet");function constructYamlSet(data){return data!==null?data:{}}__name(constructYamlSet,"constructYamlSet");var set={tag:"tag:yaml.org,2002:set",construct:constructYamlSet,kind:"mapping",resolve:resolveYamlSet};var str={tag:"tag:yaml.org,2002:str",resolve(){return!0},construct(data){return data!==null?data:""},kind:"scalar"};var YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(data){return data===null?!1:YAML_DATE_REGEXP.exec(data)!==null||YAML_TIMESTAMP_REGEXP.exec(data)!==null}__name(resolveYamlTimestamp,"resolveYamlTimestamp");function constructYamlTimestamp(data){let match=YAML_DATE_REGEXP.exec(data);if(match===null&&(match=YAML_TIMESTAMP_REGEXP.exec(data)),match===null)throw new Error("Date resolve error");let year=+match[1],month=+match[2]-1,day=+match[3];if(!match[4])return new Date(Date.UTC(year,month,day));let hour=+match[4],minute=+match[5],second=+match[6],fraction=0;if(match[7]){let partFraction=match[7].slice(0,3);for(;partFraction.length<3;)partFraction+="0";fraction=+partFraction}let delta=null;if(match[9]&&match[10]){let tzHour=+match[10],tzMinute=+(match[11]||0);delta=(tzHour*60+tzMinute)*6e4,match[9]==="-"&&(delta=-delta)}let date=new Date(Date.UTC(year,month,day,hour,minute,second,fraction));return delta&&date.setTime(date.getTime()-delta),date}__name(constructYamlTimestamp,"constructYamlTimestamp");function representYamlTimestamp(date){return date.toISOString()}__name(representYamlTimestamp,"representYamlTimestamp");var timestamp={tag:"tag:yaml.org,2002:timestamp",construct:constructYamlTimestamp,predicate(object){return object instanceof Date},kind:"scalar",represent:representYamlTimestamp,resolve:resolveYamlTimestamp};var undefinedType={tag:"tag:yaml.org,2002:js/undefined",kind:"scalar",resolve(){return!0},construct(){},predicate(object){return typeof object>"u"},represent(){return""}};function compileList(schema,name,result){let exclude=[];for(let includedSchema of schema.include)result=compileList(includedSchema,name,result);for(let currentType of schema[name]){for(let[previousIndex,previousType]of result.entries())previousType.tag===currentType.tag&&previousType.kind===currentType.kind&&exclude.push(previousIndex);result.push(currentType)}return result.filter((_type,index)=>!exclude.includes(index))}__name(compileList,"compileList");function compileMap(...typesList){let result={fallback:{},mapping:{},scalar:{},sequence:{}};for(let types of typesList)for(let type of types)result[type.kind][type.tag]=result.fallback[type.tag]=type;return result}__name(compileMap,"compileMap");var Schema=class{static{__name(this,"Schema")}implicit;explicit;include;compiledImplicit;compiledExplicit;compiledTypeMap;constructor(definition){this.explicit=definition.explicit||[],this.implicit=definition.implicit||[],this.include=definition.include||[],this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=compileMap(this.compiledImplicit,this.compiledExplicit)}},FAILSAFE_SCHEMA=new Schema({explicit:[str,seq,map]}),JSON_SCHEMA=new Schema({implicit:[nil,bool,int,float2],include:[FAILSAFE_SCHEMA]}),CORE_SCHEMA=new Schema({include:[JSON_SCHEMA]}),DEFAULT_SCHEMA=new Schema({explicit:[binary,omap,pairs,set],implicit:[timestamp,merge2],include:[CORE_SCHEMA]}),EXTENDED_SCHEMA=new Schema({explicit:[regexp,undefinedType],include:[DEFAULT_SCHEMA]}),SCHEMA_MAP=new Map([["core",CORE_SCHEMA],["default",DEFAULT_SCHEMA],["failsafe",FAILSAFE_SCHEMA],["json",JSON_SCHEMA],["extended",EXTENDED_SCHEMA]]);var CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i,ESCAPED_HEX_LENGTHS=new Map([[120,2],[117,4],[85,8]]),SIMPLE_ESCAPE_SEQUENCES=new Map([[48,"\0"],[97,"\x07"],[98,"\b"],[116,"	"],[9,"	"],[110,`
`],[118,"\v"],[102,"\f"],[114,"\r"],[101,"\x1B"],[32," "],[34,'"'],[47,"/"],[92,"\\"],[78,""],[95," "],[76,"\u2028"],[80,"\u2029"]]);function hexCharCodeToNumber(charCode){if(48<=charCode&&charCode<=57)return charCode-48;let lc=charCode|32;return 97<=lc&&lc<=102?lc-97+10:-1}__name(hexCharCodeToNumber,"hexCharCodeToNumber");function decimalCharCodeToNumber(charCode){return 48<=charCode&&charCode<=57?charCode-48:-1}__name(decimalCharCodeToNumber,"decimalCharCodeToNumber");function codepointToChar(codepoint){return codepoint<=65535?String.fromCharCode(codepoint):String.fromCharCode((codepoint-65536>>10)+55296,(codepoint-65536&1023)+56320)}__name(codepointToChar,"codepointToChar");var LoaderState=class{static{__name(this,"LoaderState")}schema;input;length;lineIndent=0;lineStart=0;position=0;line=0;onWarning;allowDuplicateKeys;implicitTypes;typeMap;version;checkLineBreaks=!1;tagMap=Object.create(null);anchorMap=Object.create(null);tag;anchor;kind;result="";constructor(input,{schema=DEFAULT_SCHEMA,onWarning,allowDuplicateKeys=!1}){this.schema=schema,this.input=input,this.onWarning=onWarning,this.allowDuplicateKeys=allowDuplicateKeys,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=input.length,this.readIndent()}readIndent(){let char=this.peek();for(;char===32;)this.lineIndent+=1,char=this.next()}peek(offset=0){return this.input.charCodeAt(this.position+offset)}next(){return this.position+=1,this.peek()}#createError(message){let mark=new Mark(this.input,this.position,this.line,this.position-this.lineStart);return new SyntaxError(`${message} ${mark}`)}throwError(message){throw this.#createError(message)}dispatchWarning(message){let error=this.#createError(message);this.onWarning?.(error)}readDocument(){let documentStart=this.position,position,directiveName,directiveArgs,hasDirectives=!1,ch;for(this.version=null,this.checkLineBreaks=!1,this.tagMap=Object.create(null),this.anchorMap=Object.create(null);(ch=this.peek())!==0&&(skipSeparationSpace(this,!0,-1),ch=this.peek(),!(this.lineIndent>0||ch!==37));){for(hasDirectives=!0,ch=this.next(),position=this.position;ch!==0&&!isWhiteSpaceOrEOL(ch);)ch=this.next();if(directiveName=this.input.slice(position,this.position),directiveArgs=[],directiveName.length<1)return this.throwError("directive name must not be less than one character in length");for(;ch!==0;){for(;isWhiteSpace(ch);)ch=this.next();if(ch===35){do ch=this.next();while(ch!==0&&!isEOL(ch));break}if(isEOL(ch))break;for(position=this.position;ch!==0&&!isWhiteSpaceOrEOL(ch);)ch=this.next();directiveArgs.push(this.input.slice(position,this.position))}switch(ch!==0&&readLineBreak(this),directiveName){case"YAML":yamlDirectiveHandler(this,...directiveArgs);break;case"TAG":tagDirectiveHandler(this,...directiveArgs);break;default:this.dispatchWarning(`unknown document directive "${directiveName}"`);break}}if(skipSeparationSpace(this,!0,-1),this.lineIndent===0&&this.peek()===45&&this.peek(1)===45&&this.peek(2)===45)this.position+=3,skipSeparationSpace(this,!0,-1);else if(hasDirectives)return this.throwError("directives end mark is expected");if(composeNode(this,this.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(this,!0,-1),this.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(this.input.slice(documentStart,this.position))&&this.dispatchWarning("non-ASCII line breaks are interpreted as content"),this.position===this.lineStart&&testDocumentSeparator(this))this.peek()===46&&(this.position+=3,skipSeparationSpace(this,!0,-1));else if(this.position<this.length-1)return this.throwError("end of the stream or a document separator is expected");return this.result}*readDocuments(){for(;this.position<this.length-1;)yield this.readDocument()}};function yamlDirectiveHandler(state,...args){if(state.version!==null)return state.throwError("duplication of %YAML directive");if(args.length!==1)return state.throwError("YAML directive accepts exactly one argument");let match=/^([0-9]+)\.([0-9]+)$/.exec(args[0]);if(match===null)return state.throwError("ill-formed argument of the YAML directive");let major=parseInt(match[1],10),minor=parseInt(match[2],10);if(major!==1)return state.throwError("unacceptable YAML version of the document");if(state.version=args[0],state.checkLineBreaks=minor<2,minor!==1&&minor!==2)return state.dispatchWarning("unsupported YAML version of the document")}__name(yamlDirectiveHandler,"yamlDirectiveHandler");function tagDirectiveHandler(state,...args){if(args.length!==2)return state.throwError("TAG directive accepts exactly two arguments");let handle=args[0],prefix=args[1];if(!PATTERN_TAG_HANDLE.test(handle))return state.throwError("ill-formed tag handle (first argument) of the TAG directive");if(Object.hasOwn(state.tagMap,handle))return state.throwError(`there is a previously declared suffix for "${handle}" tag handle`);if(!PATTERN_TAG_URI.test(prefix))return state.throwError("ill-formed tag prefix (second argument) of the TAG directive");state.tagMap[handle]=prefix}__name(tagDirectiveHandler,"tagDirectiveHandler");function captureSegment(state,start,end,checkJson){let result;if(start<end){if(result=state.input.slice(start,end),checkJson)for(let position=0;position<result.length;position++){let character2=result.charCodeAt(position);if(!(character2===9||32<=character2&&character2<=1114111))return state.throwError("expected valid JSON character")}else if(PATTERN_NON_PRINTABLE.test(result))return state.throwError("the stream contains non-printable characters");state.result+=result}}__name(captureSegment,"captureSegment");function mergeMappings(state,destination,source,overridableKeys){if(!isObject(source))return state.throwError("cannot merge mappings; the provided source object is unacceptable");for(let[key,value2]of Object.entries(source))Object.hasOwn(destination,key)||(Object.defineProperty(destination,key,{value:value2,writable:!0,enumerable:!0,configurable:!0}),overridableKeys[key]=!0)}__name(mergeMappings,"mergeMappings");function storeMappingPair(state,result,overridableKeys,keyTag,keyNode,valueNode,startLine,startPos){if(Array.isArray(keyNode)){keyNode=Array.prototype.slice.call(keyNode);for(let index=0;index<keyNode.length;index++){if(Array.isArray(keyNode[index]))return state.throwError("nested arrays are not supported inside keys");typeof keyNode=="object"&&getObjectTypeString(keyNode[index])==="[object Object]"&&(keyNode[index]="[object Object]")}}if(typeof keyNode=="object"&&getObjectTypeString(keyNode)==="[object Object]"&&(keyNode="[object Object]"),keyNode=String(keyNode),result===null&&(result={}),keyTag==="tag:yaml.org,2002:merge")if(Array.isArray(valueNode))for(let index=0;index<valueNode.length;index++)mergeMappings(state,result,valueNode[index],overridableKeys);else mergeMappings(state,result,valueNode,overridableKeys);else{if(!state.allowDuplicateKeys&&!Object.hasOwn(overridableKeys,keyNode)&&Object.hasOwn(result,keyNode))return state.line=startLine||state.line,state.position=startPos||state.position,state.throwError("duplicated mapping key");Object.defineProperty(result,keyNode,{value:valueNode,writable:!0,enumerable:!0,configurable:!0}),delete overridableKeys[keyNode]}return result}__name(storeMappingPair,"storeMappingPair");function readLineBreak(state){let ch=state.peek();if(ch===10)state.position++;else if(ch===13)state.position++,state.peek()===10&&state.position++;else return state.throwError("a line break is expected");state.line+=1,state.lineStart=state.position}__name(readLineBreak,"readLineBreak");function skipSeparationSpace(state,allowComments,checkIndent){let lineBreaks=0,ch=state.peek();for(;ch!==0;){for(;isWhiteSpace(ch);)ch=state.next();if(allowComments&&ch===35)do ch=state.next();while(ch!==10&&ch!==13&&ch!==0);if(isEOL(ch))readLineBreak(state),ch=state.peek(),lineBreaks++,state.lineIndent=0,state.readIndent(),ch=state.peek();else break}return checkIndent!==-1&&lineBreaks!==0&&state.lineIndent<checkIndent&&state.dispatchWarning("deficient indentation"),lineBreaks}__name(skipSeparationSpace,"skipSeparationSpace");function testDocumentSeparator(state){let ch=state.peek();return!!((ch===45||ch===46)&&ch===state.peek(1)&&ch===state.peek(2)&&(ch=state.peek(3),ch===0||isWhiteSpaceOrEOL(ch)))}__name(testDocumentSeparator,"testDocumentSeparator");function writeFoldedLines(state,count){count===1?state.result+=" ":count>1&&(state.result+=`
`.repeat(count-1))}__name(writeFoldedLines,"writeFoldedLines");function readPlainScalar(state,nodeIndent,withinFlowCollection){let kind=state.kind,result=state.result,ch=state.peek();if(isWhiteSpaceOrEOL(ch)||isFlowIndicator(ch)||ch===35||ch===38||ch===42||ch===33||ch===124||ch===62||ch===39||ch===34||ch===37||ch===64||ch===96)return!1;let following;if((ch===63||ch===45)&&(following=state.peek(1),isWhiteSpaceOrEOL(following)||withinFlowCollection&&isFlowIndicator(following)))return!1;state.kind="scalar",state.result="";let captureEnd=state.position,captureStart=state.position,hasPendingContent=!1,line=0;for(;ch!==0;){if(ch===58){if(following=state.peek(1),isWhiteSpaceOrEOL(following)||withinFlowCollection&&isFlowIndicator(following))break}else if(ch===35){let preceding=state.peek(-1);if(isWhiteSpaceOrEOL(preceding))break}else{if(state.position===state.lineStart&&testDocumentSeparator(state)||withinFlowCollection&&isFlowIndicator(ch))break;if(isEOL(ch)){line=state.line;let lineStart=state.lineStart,lineIndent=state.lineIndent;if(skipSeparationSpace(state,!1,-1),state.lineIndent>=nodeIndent){hasPendingContent=!0,ch=state.peek();continue}else{state.position=captureEnd,state.line=line,state.lineStart=lineStart,state.lineIndent=lineIndent;break}}}hasPendingContent&&(captureSegment(state,captureStart,captureEnd,!1),writeFoldedLines(state,state.line-line),captureStart=captureEnd=state.position,hasPendingContent=!1),isWhiteSpace(ch)||(captureEnd=state.position+1),ch=state.next()}return captureSegment(state,captureStart,captureEnd,!1),state.result?!0:(state.kind=kind,state.result=result,!1)}__name(readPlainScalar,"readPlainScalar");function readSingleQuotedScalar(state,nodeIndent){let ch,captureStart,captureEnd;if(ch=state.peek(),ch!==39)return!1;for(state.kind="scalar",state.result="",state.position++,captureStart=captureEnd=state.position;(ch=state.peek())!==0;)if(ch===39)if(captureSegment(state,captureStart,state.position,!0),ch=state.next(),ch===39)captureStart=state.position,state.position++,captureEnd=state.position;else return!0;else if(isEOL(ch))captureSegment(state,captureStart,captureEnd,!0),writeFoldedLines(state,skipSeparationSpace(state,!1,nodeIndent)),captureStart=captureEnd=state.position;else{if(state.position===state.lineStart&&testDocumentSeparator(state))return state.throwError("unexpected end of the document within a single quoted scalar");state.position++,captureEnd=state.position}return state.throwError("unexpected end of the stream within a single quoted scalar")}__name(readSingleQuotedScalar,"readSingleQuotedScalar");function readDoubleQuotedScalar(state,nodeIndent){let ch=state.peek();if(ch!==34)return!1;state.kind="scalar",state.result="",state.position++;let captureEnd=state.position,captureStart=state.position,tmp;for(;(ch=state.peek())!==0;){if(ch===34)return captureSegment(state,captureStart,state.position,!0),state.position++,!0;if(ch===92){if(captureSegment(state,captureStart,state.position,!0),ch=state.next(),isEOL(ch))skipSeparationSpace(state,!1,nodeIndent);else if(ch<256&&SIMPLE_ESCAPE_SEQUENCES.has(ch))state.result+=SIMPLE_ESCAPE_SEQUENCES.get(ch),state.position++;else if((tmp=ESCAPED_HEX_LENGTHS.get(ch)??0)>0){let hexLength=tmp,hexResult=0;for(;hexLength>0;hexLength--)if(ch=state.next(),(tmp=hexCharCodeToNumber(ch))>=0)hexResult=(hexResult<<4)+tmp;else return state.throwError("expected hexadecimal character");state.result+=codepointToChar(hexResult),state.position++}else return state.throwError("unknown escape sequence");captureStart=captureEnd=state.position}else if(isEOL(ch))captureSegment(state,captureStart,captureEnd,!0),writeFoldedLines(state,skipSeparationSpace(state,!1,nodeIndent)),captureStart=captureEnd=state.position;else{if(state.position===state.lineStart&&testDocumentSeparator(state))return state.throwError("unexpected end of the document within a double quoted scalar");state.position++,captureEnd=state.position}}return state.throwError("unexpected end of the stream within a double quoted scalar")}__name(readDoubleQuotedScalar,"readDoubleQuotedScalar");function readFlowCollection(state,nodeIndent){let ch=state.peek(),terminator,isMapping=!0,result={};if(ch===91)terminator=93,isMapping=!1,result=[];else if(ch===123)terminator=125;else return!1;state.anchor!==null&&typeof state.anchor<"u"&&(state.anchorMap[state.anchor]=result),ch=state.next();let tag=state.tag,anchor=state.anchor,readNext=!0,valueNode=null,keyNode=null,keyTag=null,isExplicitPair=!1,isPair=!1,following=0,line=0,overridableKeys=Object.create(null);for(;ch!==0;){if(skipSeparationSpace(state,!0,nodeIndent),ch=state.peek(),ch===terminator)return state.position++,state.tag=tag,state.anchor=anchor,state.kind=isMapping?"mapping":"sequence",state.result=result,!0;if(!readNext)return state.throwError("missed comma between flow collection entries");keyTag=keyNode=valueNode=null,isPair=isExplicitPair=!1,ch===63&&(following=state.peek(1),isWhiteSpaceOrEOL(following)&&(isPair=isExplicitPair=!0,state.position++,skipSeparationSpace(state,!0,nodeIndent))),line=state.line,composeNode(state,nodeIndent,CONTEXT_FLOW_IN,!1,!0),keyTag=state.tag||null,keyNode=state.result,skipSeparationSpace(state,!0,nodeIndent),ch=state.peek(),(isExplicitPair||state.line===line)&&ch===58&&(isPair=!0,ch=state.next(),skipSeparationSpace(state,!0,nodeIndent),composeNode(state,nodeIndent,CONTEXT_FLOW_IN,!1,!0),valueNode=state.result),isMapping?storeMappingPair(state,result,overridableKeys,keyTag,keyNode,valueNode):isPair?result.push(storeMappingPair(state,null,overridableKeys,keyTag,keyNode,valueNode)):result.push(keyNode),skipSeparationSpace(state,!0,nodeIndent),ch=state.peek(),ch===44?(readNext=!0,ch=state.next()):readNext=!1}return state.throwError("unexpected end of the stream within a flow collection")}__name(readFlowCollection,"readFlowCollection");function readBlockScalar(state,nodeIndent){let chomping=CHOMPING_CLIP,didReadContent=!1,detectedIndent=!1,textIndent=nodeIndent,emptyLines=0,atMoreIndented=!1,ch=state.peek(),folding=!1;if(ch===124)folding=!1;else if(ch===62)folding=!0;else return!1;state.kind="scalar",state.result="";let tmp=0;for(;ch!==0;)if(ch=state.next(),ch===43||ch===45)if(CHOMPING_CLIP===chomping)chomping=ch===43?CHOMPING_KEEP:CHOMPING_STRIP;else return state.throwError("repeat of a chomping mode identifier");else if((tmp=decimalCharCodeToNumber(ch))>=0){if(tmp===0)return state.throwError("bad explicit indentation width of a block scalar; it cannot be less than one");if(!detectedIndent)textIndent=nodeIndent+tmp-1,detectedIndent=!0;else return state.throwError("repeat of an indentation width identifier")}else break;if(isWhiteSpace(ch)){do ch=state.next();while(isWhiteSpace(ch));if(ch===35)do ch=state.next();while(!isEOL(ch)&&ch!==0)}for(;ch!==0;){for(readLineBreak(state),state.lineIndent=0,ch=state.peek();(!detectedIndent||state.lineIndent<textIndent)&&ch===32;)state.lineIndent++,ch=state.next();if(!detectedIndent&&state.lineIndent>textIndent&&(textIndent=state.lineIndent),isEOL(ch)){emptyLines++;continue}if(state.lineIndent<textIndent){chomping===CHOMPING_KEEP?state.result+=`
`.repeat(didReadContent?1+emptyLines:emptyLines):chomping===CHOMPING_CLIP&&didReadContent&&(state.result+=`
`);break}folding?isWhiteSpace(ch)?(atMoreIndented=!0,state.result+=`
`.repeat(didReadContent?1+emptyLines:emptyLines)):atMoreIndented?(atMoreIndented=!1,state.result+=`
`.repeat(emptyLines+1)):emptyLines===0?didReadContent&&(state.result+=" "):state.result+=`
`.repeat(emptyLines):state.result+=`
`.repeat(didReadContent?1+emptyLines:emptyLines),didReadContent=!0,detectedIndent=!0,emptyLines=0;let captureStart=state.position;for(;!isEOL(ch)&&ch!==0;)ch=state.next();captureSegment(state,captureStart,state.position,!1)}return!0}__name(readBlockScalar,"readBlockScalar");function readBlockSequence(state,nodeIndent){let line,following,detected=!1,ch,tag=state.tag,anchor=state.anchor,result=[];for(state.anchor!==null&&typeof state.anchor<"u"&&(state.anchorMap[state.anchor]=result),ch=state.peek();ch!==0&&!(ch!==45||(following=state.peek(1),!isWhiteSpaceOrEOL(following)));){if(detected=!0,state.position++,skipSeparationSpace(state,!0,-1)&&state.lineIndent<=nodeIndent){result.push(null),ch=state.peek();continue}if(line=state.line,composeNode(state,nodeIndent,CONTEXT_BLOCK_IN,!1,!0),result.push(state.result),skipSeparationSpace(state,!0,-1),ch=state.peek(),(state.line===line||state.lineIndent>nodeIndent)&&ch!==0)return state.throwError("bad indentation of a sequence entry");if(state.lineIndent<nodeIndent)break}return detected?(state.tag=tag,state.anchor=anchor,state.kind="sequence",state.result=result,!0):!1}__name(readBlockSequence,"readBlockSequence");function readBlockMapping(state,nodeIndent,flowIndent){let tag=state.tag,anchor=state.anchor,result={},overridableKeys=Object.create(null),following,allowCompact=!1,line,pos,keyTag=null,keyNode=null,valueNode=null,atExplicitKey=!1,detected=!1,ch;for(state.anchor!==null&&typeof state.anchor<"u"&&(state.anchorMap[state.anchor]=result),ch=state.peek();ch!==0;){if(following=state.peek(1),line=state.line,pos=state.position,(ch===63||ch===58)&&isWhiteSpaceOrEOL(following)){if(ch===63)atExplicitKey&&(storeMappingPair(state,result,overridableKeys,keyTag,keyNode,null),keyTag=keyNode=valueNode=null),detected=!0,atExplicitKey=!0,allowCompact=!0;else if(atExplicitKey)atExplicitKey=!1,allowCompact=!0;else return state.throwError("incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line");state.position+=1,ch=following}else if(composeNode(state,flowIndent,CONTEXT_FLOW_OUT,!1,!0))if(state.line===line){for(ch=state.peek();isWhiteSpace(ch);)ch=state.next();if(ch===58){if(ch=state.next(),!isWhiteSpaceOrEOL(ch))return state.throwError("a whitespace character is expected after the key-value separator within a block mapping");atExplicitKey&&(storeMappingPair(state,result,overridableKeys,keyTag,keyNode,null),keyTag=keyNode=valueNode=null),detected=!0,atExplicitKey=!1,allowCompact=!1,keyTag=state.tag,keyNode=state.result}else return detected?state.throwError("can not read an implicit mapping pair; a colon is missed"):(state.tag=tag,state.anchor=anchor,!0)}else return detected?state.throwError("can not read a block mapping entry; a multiline key may not be an implicit key"):(state.tag=tag,state.anchor=anchor,!0);else break;if((state.line===line||state.lineIndent>nodeIndent)&&(composeNode(state,nodeIndent,CONTEXT_BLOCK_OUT,!0,allowCompact)&&(atExplicitKey?keyNode=state.result:valueNode=state.result),atExplicitKey||(storeMappingPair(state,result,overridableKeys,keyTag,keyNode,valueNode,line,pos),keyTag=keyNode=valueNode=null),skipSeparationSpace(state,!0,-1),ch=state.peek()),state.lineIndent>nodeIndent&&ch!==0)return state.throwError("bad indentation of a mapping entry");if(state.lineIndent<nodeIndent)break}return atExplicitKey&&storeMappingPair(state,result,overridableKeys,keyTag,keyNode,null),detected&&(state.tag=tag,state.anchor=anchor,state.kind="mapping",state.result=result),detected}__name(readBlockMapping,"readBlockMapping");function readTagProperty(state){let position,isVerbatim=!1,isNamed=!1,tagHandle="",tagName,ch;if(ch=state.peek(),ch!==33)return!1;if(state.tag!==null)return state.throwError("duplication of a tag property");if(ch=state.next(),ch===60?(isVerbatim=!0,ch=state.next()):ch===33?(isNamed=!0,tagHandle="!!",ch=state.next()):tagHandle="!",position=state.position,isVerbatim){do ch=state.next();while(ch!==0&&ch!==62);if(state.position<state.length)tagName=state.input.slice(position,state.position),ch=state.next();else return state.throwError("unexpected end of the stream within a verbatim tag")}else{for(;ch!==0&&!isWhiteSpaceOrEOL(ch);){if(ch===33){if(isNamed)return state.throwError("tag suffix cannot contain exclamation marks");if(tagHandle=state.input.slice(position-1,state.position+1),!PATTERN_TAG_HANDLE.test(tagHandle))return state.throwError("named tag handle cannot contain such characters");isNamed=!0,position=state.position+1}ch=state.next()}if(tagName=state.input.slice(position,state.position),PATTERN_FLOW_INDICATORS.test(tagName))return state.throwError("tag suffix cannot contain flow indicator characters")}if(tagName&&!PATTERN_TAG_URI.test(tagName))return state.throwError(`tag name cannot contain such characters: ${tagName}`);if(isVerbatim)state.tag=tagName;else if(Object.hasOwn(state.tagMap,tagHandle))state.tag=state.tagMap[tagHandle]+tagName;else if(tagHandle==="!")state.tag=`!${tagName}`;else if(tagHandle==="!!")state.tag=`tag:yaml.org,2002:${tagName}`;else return state.throwError(`undeclared tag handle "${tagHandle}"`);return!0}__name(readTagProperty,"readTagProperty");function readAnchorProperty(state){let ch=state.peek();if(ch!==38)return!1;if(state.anchor!==null)return state.throwError("duplication of an anchor property");ch=state.next();let position=state.position;for(;ch!==0&&!isWhiteSpaceOrEOL(ch)&&!isFlowIndicator(ch);)ch=state.next();return state.position===position?state.throwError("name of an anchor node must contain at least one character"):(state.anchor=state.input.slice(position,state.position),!0)}__name(readAnchorProperty,"readAnchorProperty");function readAlias(state){if(state.peek()!==42)return!1;let ch=state.next(),position=state.position;for(;ch!==0&&!isWhiteSpaceOrEOL(ch)&&!isFlowIndicator(ch);)ch=state.next();if(state.position===position)return state.throwError("name of an alias node must contain at least one character");let alias=state.input.slice(position,state.position);return Object.hasOwn(state.anchorMap,alias)?(state.result=state.anchorMap[alias],skipSeparationSpace(state,!0,-1),!0):state.throwError(`unidentified alias "${alias}"`)}__name(readAlias,"readAlias");function composeNode(state,parentIndent,nodeContext,allowToSeek,allowCompact){let allowBlockScalars,allowBlockCollections,indentStatus=1,atNewLine=!1,hasContent=!1,type,flowIndent,blockIndent;state.tag=null,state.anchor=null,state.kind=null,state.result=null;let allowBlockStyles=allowBlockScalars=allowBlockCollections=CONTEXT_BLOCK_OUT===nodeContext||CONTEXT_BLOCK_IN===nodeContext;if(allowToSeek&&skipSeparationSpace(state,!0,-1)&&(atNewLine=!0,state.lineIndent>parentIndent?indentStatus=1:state.lineIndent===parentIndent?indentStatus=0:state.lineIndent<parentIndent&&(indentStatus=-1)),indentStatus===1)for(;readTagProperty(state)||readAnchorProperty(state);)skipSeparationSpace(state,!0,-1)?(atNewLine=!0,allowBlockCollections=allowBlockStyles,state.lineIndent>parentIndent?indentStatus=1:state.lineIndent===parentIndent?indentStatus=0:state.lineIndent<parentIndent&&(indentStatus=-1)):allowBlockCollections=!1;if(allowBlockCollections&&(allowBlockCollections=atNewLine||allowCompact),indentStatus===1||CONTEXT_BLOCK_OUT===nodeContext)if(flowIndent=CONTEXT_FLOW_IN===nodeContext||CONTEXT_FLOW_OUT===nodeContext?parentIndent:parentIndent+1,blockIndent=state.position-state.lineStart,indentStatus===1)if(allowBlockCollections&&(readBlockSequence(state,blockIndent)||readBlockMapping(state,blockIndent,flowIndent))||readFlowCollection(state,flowIndent))hasContent=!0;else{if(allowBlockScalars&&readBlockScalar(state,flowIndent)||readSingleQuotedScalar(state,flowIndent)||readDoubleQuotedScalar(state,flowIndent))hasContent=!0;else if(readAlias(state)){if(hasContent=!0,state.tag!==null||state.anchor!==null)return state.throwError("alias node should not have Any properties")}else readPlainScalar(state,flowIndent,CONTEXT_FLOW_IN===nodeContext)&&(hasContent=!0,state.tag===null&&(state.tag="?"));state.anchor!==null&&(state.anchorMap[state.anchor]=state.result)}else indentStatus===0&&(hasContent=allowBlockCollections&&readBlockSequence(state,blockIndent));if(state.tag!==null&&state.tag!=="!")if(state.tag==="?"){for(let typeIndex=0;typeIndex<state.implicitTypes.length;typeIndex++)if(type=state.implicitTypes[typeIndex],type.resolve(state.result)){state.result=type.construct(state.result),state.tag=type.tag,state.anchor!==null&&(state.anchorMap[state.anchor]=state.result);break}}else if(Object.hasOwn(state.typeMap[state.kind||"fallback"],state.tag)){if(type=state.typeMap[state.kind||"fallback"][state.tag],state.result!==null&&type.kind!==state.kind)return state.throwError(`unacceptable node kind for !<${state.tag}> tag; it should be "${type.kind}", not "${state.kind}"`);if(type.resolve(state.result))state.result=type.construct(state.result),state.anchor!==null&&(state.anchorMap[state.anchor]=state.result);else return state.throwError(`cannot resolve a node with !<${state.tag}> explicit tag`)}else return state.throwError(`unknown tag !<${state.tag}>`);return state.tag!==null||state.anchor!==null||hasContent}__name(composeNode,"composeNode");function sanitizeInput(input){return input=String(input),input.length>0&&(isEOL(input.charCodeAt(input.length-1))||(input+=`
`),input.charCodeAt(0)===65279&&(input=input.slice(1))),input+="\0",input}__name(sanitizeInput,"sanitizeInput");function load(input,options={}){input=sanitizeInput(input);let documentGenerator=new LoaderState(input,options).readDocuments(),document=documentGenerator.next().value;if(!documentGenerator.next().done)throw new SyntaxError("expected a single document in the stream, but found more");return document??null}__name(load,"load");function parse3(content,options={}){return load(content,{...options,schema:SCHEMA_MAP.get(options.schema)})}__name(parse3,"parse");var import_ini=__toESM(require_ini(),1);import{parse as parseEnv}from"dotenv";import{findUpMultiple}from"find-up";import memoizeFs from"memoize-fs";var{isArray}=Array;function curry(fn,args=[]){return(..._args)=>(rest=>rest.length>=fn.length?fn(...rest):curry(fn,rest))([...args,..._args])}__name(curry,"curry");var ReduceStopper=class{static{__name(this,"ReduceStopper")}constructor(value2){this.value=value2}};function reduceFn(reducer,acc,list){if(list==null)return acc;if(!isArray(list))throw new TypeError("reduce: list must be array or iterable");let index=0,len=list.length;for(;index<len;){if(acc=reducer(acc,list[index],index,list),acc instanceof ReduceStopper)return acc.value;index++}return acc}__name(reduceFn,"reduceFn");var reduce=curry(reduceFn);function pipeAsync(...fnList){return function(startArgument){return reduce(async(value2,fn)=>fn(await value2),startArgument,fnList)}}__name(pipeAsync,"pipeAsync");async function mapParallelAsyncFn(fn,arr){let promised=arr.map((a,i)=>fn(a,i));return Promise.all(promised)}__name(mapParallelAsyncFn,"mapParallelAsyncFn");function mapParallelAsync(fn,arr){return arguments.length===1?async holder=>mapParallelAsyncFn(fn,holder):new Promise((resolve2,reject)=>{mapParallelAsyncFn(fn,arr).then(resolve2).catch(reject)})}__name(mapParallelAsync,"mapParallelAsync");function pipedAsync(input,...fnList){return pipeAsync(...fnList)(input)}__name(pipedAsync,"pipedAsync");var dotlessExtToType=new Map([["json","jsonc"],["jsonl","jsonl"],["log","jsonl"],["yaml","yaml"],["yml","yaml"],["toml","toml"],["ini","ini"],["npmrc","ini"],["env","env"]]),pathToType=__name(async inputPath=>dotlessExtToType.get((await path.parseFs(inputPath)).ext.slice(1)),"pathToType"),parse4=__name((input,inputType)=>{if(inputType==="jsonl")return parse(`[${input.split(`
`).filter(inputLine=>inputLine.trim()).map(nonEmptyInputLine=>nonEmptyInputLine.endsWith(",")?nonEmptyInputLine:`${nonEmptyInputLine},`).join(`
`)}]`);if(inputType==="jsonc")return parse(input);if(inputType==="toml")return parse2(input);if(inputType==="env")return parseEnv(input);if(inputType==="ini")return(0,import_ini.parse)(input);if(inputType==="yaml")return parse3(input);throw new Error(`unsupported inputType ${inputType}`)},"parse"),isSchemaAsync=__name(schema=>Object.hasOwn(schema,"parseAsync"),"isSchemaAsync"),memoizer=memoizeFs({cachePath:"dist/temp/cache/",cacheId:"data",astBody:!0,retryOnInvalidCache:!0}),toJsWoCache=__name(async(input,inputPath,options)=>{let inputDotlessExt=(await path.parseFs(inputPath)).ext.slice(1),mergeParent=options?.mergeParent??!1,mergeParents=mergeParent===!0?[`index.${inputDotlessExt}`]:mergeParent===!1?[]:typeof mergeParent=="string"?[mergeParent]:mergeParent,schema=options?.schema??!1,injectMetadata=options?.injectMetadata??!1,ownJson=parse4(input,dotlessExtToType.get(inputDotlessExt)),pkgJsonAbsPath=(await pm(inputPath)).packageAbsDir,mergedJson=mergeParent?{...await pipedAsync(await findUpMultiple(mergeParents,{cwd:(await path.parseFs(inputPath)).dir,stopAt:pkgJsonAbsPath}),async indexAbsPaths=>await mapParallelAsync(async indexAbsPath=>await pipedAsync(indexAbsPath,fs.readFileU,async input2=>parse4(input2,await pathToType(indexAbsPath))),indexAbsPaths),indexTomlContents=>indexTomlContents.toReversed(),reversedIndexTomlContents=>Object.assign({},...reversedIndexTomlContents)),...ownJson}:ownJson,injectedJson=injectMetadata?{...mergedJson,path:await path.parseFs(inputPath),pkgJsonAbsPath}:mergedJson,schemaed=schema?isSchemaAsync(schema)?await schema.parseAsync(injectedJson):await schema.parse(injectedJson):injectedJson;return`export default ${toExport(schemaed)}`},"toJsWoCache"),toJs=await memoizer.fn(toJsWoCache);describe("empty",async()=>{it("toml",async()=>{assert.deepStrictEqual(await toJs("","index.toml"),"export default Object.freeze(Object.fromEntries([]))")}),it("json",async()=>{assert.deepStrictEqual(await toJs("{}","index.json"),"export default Object.freeze(Object.fromEntries([]))")}),it("jsonl",async()=>{assert.deepStrictEqual(await toJs("{}","index.jsonl"),"export default Object.freeze([Object.freeze(Object.fromEntries([]))])")})});
